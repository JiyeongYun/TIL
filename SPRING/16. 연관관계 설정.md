**ğŸ”—** ì¶”ê°€ë¡œ ì„¤ì •í•´ì•¼ í•  ì—°ê´€ ê´€ê³„ **ğŸ”—**

1. User ì™€ OrderGroup í…Œì´ë¸” 1:N ê´€ê³„
2. OrderGroupê³¼ OrderDetail í…Œì´ë¸” 1:N ê´€ê³„
3. Item ê³¼ OrderDetail 1:N ê´€ê³„
4. Parterì™€ item 1:N ê´€ê³„
5. Categoryì™€ Partner 1:N ê´€ê³„

## ì—°ê´€ê´€ê³„ ì„¤ì •

### 1. User ì™€ OrderGroup í…Œì´ë¸” 1:N ê´€ê³„

- **User ê¸°ì¤€**
    1. User ê¸°ì¤€ìœ¼ë¡œ OrderGroupì€ Nê°œì´ê¸° ë•Œë¬¸ì— List íƒ€ì…ìœ¼ë¡œ ë³€ìˆ˜ë¥¼ ìƒì„±
        - **@OneToMany** annotation ì¶”ê°€
            - ì´ë•Œ, FetchTypeì€ LAZY(ì§€ì—°ë¡œë”©)
            - ì´ ë³€ìˆ˜ëŠ” user ë³€ìˆ˜ì™€ ë§¤í•‘

        ```java
        // User 1 : N OrderGroup
        @OneToMany(fetch = FetchType.LAZY, mappedBy = "user")
        private List<OrderGroup> orderGroupList;
        ```

    2. ToString()ì—ì„œ exclude ì„¤ì •í•´ì£¼ê¸°
        - OneToMany ê´€ê³„ë‚˜ joinëœ ê´€ê³„ëŠ” toString í•  ë•Œ, overflowê°€ ë°œìƒí•˜ê¸° ë•Œë¬¸ì—

        ```java
        @ToString(exclude = {"orderGroup"})
        ```

- **OrderGroup ê¸°ì¤€**
    1. User íƒ€ì…ì˜ ë³€ìˆ˜ ìƒì„± (ê¸°ì¡´ Long userId â†’ User user)
        - **@ManyToOne** annotation ì¶”ê°€

        ```java
        // OrderGroup N : 1 User
        @ManyToOne
        private User user;
        ```

        â‡’ Userì—ì„œ mapping í•´ ì¤€ ë³€ìˆ˜ ì´ë¦„ê³¼ ì¼ì¹˜í•´ì•¼ í•¨. (user)

    2. ToString()ì—ì„œ exclude ì„¤ì •í•´ì£¼ê¸°

        ```java
        @ToString(exclude = {"user"})
        ```

- Test Connect

    UserRepositoryTest.java

    ```java
    @Test
    @Transactional
    public void read(){
        User user = userRepository.findFirstByPhoneNumberOrderByIdDesc("010-1111-2222");

        user.getOrderGroupList().stream().forEach(orderGroup -> {
            System.out.println("----------------ì£¼ë¬¸ë¬¶ìŒ------------------");
            System.out.println("ìˆ˜ë ¹ì¸: "+ orderGroup.getRevName());
            System.out.println("ìˆ˜ë ¹ì§€: "+ orderGroup.getRevAddress());
            System.out.println("ì´ê¸ˆì•¡: "+ orderGroup.getTotalPrice());
            System.out.println("ì´ìˆ˜ëŸ‰: "+ orderGroup.getTotalQuantity());
    				
    				System.out.println("----------------ì£¼ë¬¸ìƒì„¸------------------");
            orderGroup.getOrderDetailList().forEach(orderDetail -> {
                System.out.println("íŒŒíŠ¸ë„ˆì‚¬ ì´ë¦„: " + orderDetail.getItem().getPartner().getName());
                System.out.println("íŒŒíŠ¸ë„ˆì‚¬ ì¹´í…Œê³ ë¦¬: " + orderDetail.getItem().getPartner().getCategory().getTitle());
                System.out.println("ì£¼ë¬¸ ìƒí’ˆ: " + orderDetail.getItem().getName());
                System.out.println("ê³ ê°ì„¼í„° ë²ˆí˜¸: " + orderDetail.getItem().getPartner().getCallCenter());
                System.out.println("ì£¼ë¬¸ì˜ ìƒíƒœ: " + orderDetail.getStatus());
                System.out.println("ë„ì°©ì˜ˆì •ì¼ì: " + orderDetail.getArrivalDate());
            });
        });
        Assert.assertNotNull(user);
    }
    ```

â‡’ ì›ë˜ SQL ì¿¼ë¦¬ë¬¸ìœ¼ë¡œ ì‘ì„±ì„ í•˜ê³ , userì™€ ì—°ê´€ëœ ì •ë³´ë“¤ì„ ê°€ì§€ê³  ì™€ì•¼ í•  ë•Œ í…Œì´ë¸” ê°„ì— ì§€ì†ì ì¸ joinì„ í†µí•´ì„œ ê°€ì ¸ì™€ì•¼ í•¨

*â‡’ JPAë¥¼ ì‚¬ìš©í•˜ë©´ ìœ„ì™€ ê°™ì´ getItem().getPartner().getName() ë“±ë“±ì˜ ë°©ë²•ì„ ì‚¬ìš©í•´ì„œ ì‰½ê²Œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.*
