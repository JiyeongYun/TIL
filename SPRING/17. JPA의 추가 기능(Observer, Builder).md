## JPA의 추가 기능
<img width="724" alt="스크린샷 2020-11-11 오후 4 37 50" src="https://user-images.githubusercontent.com/30459523/98783037-3e7dc680-243c-11eb-9114-c57cea217694.png">

<details>
<summary>반복적인 속성들을 감시자로 자동 설정하기</summary>
<div markdown="1"> 

1. Config 설정
- config package 생성

    <img width="259" alt="스크린샷 2020-11-11 오후 4 40 45" src="https://user-images.githubusercontent.com/30459523/98783274-a7fdd500-243c-11eb-8b4f-4e17e74da3dc.png">

- JpaConfig.java 파일 생성
- **@Configuration** annotation 추가
    - 설정 파일에 대한 내용이 들어간다는 것을 의미
- **@EnableJpaAuditing** annotation 추가
    - JPA에 대해 감시를 활성화 시키는 것을 의미

2. Component 설정

- component package 생성

<img width="255" alt="스크린샷 2020-11-11 오후 4 40 53" src="https://user-images.githubusercontent.com/30459523/98783280-ab915c00-243c-11eb-9ea8-6fa23608d8ee.png">

- **@Component** annotation 추가
- AuditorAware implements하기

```java
@Component
public class LoginUserAuditorAware implements AuditorAware<String> {

    @Override
    public Optional<String> getCurrentAuditor() {
        return Optional.of("AdminServer");
    }
}
```

3. Entity의 각 attribute에 Annotation 달기
- createdAt: **@CreatedDate**
- createdBy: **@CreatedBy**
- updatedAt: **@LastModifiedDate**
- updatedBy에 **@LastModifiedBy**

ex) AdminUser.java

```java
@CreatedDate
private LocalDateTime createdAt;

@CreatedBy
private String createdBy;
    
@LastModifiedDate
private LocalDateTime updatedAt;

@LastModifiedBy
private String updatedBy;
```

4. Entity 상단에 Annotation 달기
- **@EntityListeners**(AuditingEntityListener.class)

ex) AdminUser.java

```java
@EntityListeners(AuditingEntityListener.class)
public class AdminUser {
...
```

</div>
</details>


<details>
<summary>Test</summary>
<div markdown="1"> 

- AdminUserRepositoryTest.java
    - create 메서드에서 createdAt, createdBy 주석 처리 후 실행
    - Create하는 동시에 account를 update 시켜 확인

```java
// adminUser.setCreatedAt(LocalDateTime.now());
// adminUser.setCreatedBy("AdminServer");
...
newAdminUser.setAccount("CHANGE");
adminUserRepository.save(adminUser);
```

- DB에 현재 생성하고 수정한 시간으로 들어가는 것 확인하기

</div>
</details>
